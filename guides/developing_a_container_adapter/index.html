<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Developing a Container Adapter &#183; Arquillian Guides</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="Learn how to adapt Arquillian to new backends by implementing the Container SPI" name="description" />
    <link href="/blog/atom.xml" rel="alternate" title="Arquillian blog Atom feed" type="application/atom+xml" />
    <link href="/stylesheets/screen.css?a64be9bfe706fa7c6bf4dafe5217e75bf594d112" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.js"></script>
    <![endif]-->
    <link href="/favicon.ico" rel="shortcut icon" />
  </head>
  <body class="guide">
    <header class="navbar navbar-fixed-top" id="banner" role="banner">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <div class="g-plusone-slot">
            <div class="g-plusone" data-annotation="none"></div>
          </div>
          <a class="brand" href="/">
            <span class="logo"></span>
            <span class="name">Arquillian</span>
          </a>
          <nav class="nav-collapse" role="navigation">
            <ul class="nav">
              <li><a href="/invasion/">Invasion!</a></li>
              <li><a href="/features/">Features</a></li>
              <li class="active"><a href="/guides/">Guides</a></li>
              <li><a href="/docs/">Docs</a></li>
              <li><a href="/blog/">Blog</a></li>
              <li><a href="/community/">Community</a></li>
              <li><a href="/modules/">Modules</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>
    <div id="main" role="main">
      <div id="content-header">
        <div class="container">
          <div class="headline">
            <h1>
              <a href="/guides/">Arquillian Guides</a>
              <small>Designed exclusively to teach you how to use Arquillian to write real tests.</small>
            </h1>
            <div class="directory">
              <a class="guides_menu" href="./" id="guides_menu">
                Guides Index
                <i class="icon-menu-closed"></i>
              </a>
              <div id="guides" style="display: none">
                <a class="guides_menu" href="./">
                  Guides Index
                  <i class="icon-menu-open"></i>
                </a>
                <hr class="clear" />
                <dl class="beg">
                  <dt>First Steps</dt>
                  <dd><a href="/guides/getting_started/">Getting Started</a>
                  <br />
                  <a href="/guides/getting_started/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/getting_started_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/getting_started_el_gr/"><img class="flag" rel="tooltip" src="/images/flags/el_gr.png" title="Ελληνικά (el_gr)" /></a>
                  <a href="/guides/getting_started_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
                  <a href="/guides/getting_started_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/getting_started_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
                  <a href="/guides/getting_started_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/getting_started_nl/"><img class="flag" rel="tooltip" src="/images/flags/nl.png" title="Nederlands (nl)" /></a>
                  <a href="/guides/getting_started_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
                  <a href="/guides/getting_started_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
                  <a href="/guides/getting_started_sk/"><img class="flag" rel="tooltip" src="/images/flags/sk.png" title="Slovenčina (sk)" /></a>
                  <a href="/guides/getting_started_sv_se/"><img class="flag" rel="tooltip" src="/images/flags/sv_se.png" title="Svenska (sv_se)" /></a>
                  <a href="/guides/getting_started_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                  <dd><a href="/guides/getting_started_rinse_and_repeat/">Getting Started: Rinse and Repeat</a>
                  <br />
                  <a href="/guides/getting_started_rinse_and_repeat/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                  <dd><a href="/guides/get_started_faster_with_forge/">Get Started Faster with Forge</a></dd>
                  <dd><a href="/guides/shrinkwrap_introduction/">Creating Deployable Archives with ShrinkWrap</a>
                  <br />
                  <a href="/guides/shrinkwrap_introduction/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/shrinkwrap_introduction_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/shrinkwrap_introduction_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/shrinkwrap_introduction_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
                  <a href="/guides/shrinkwrap_introduction_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/shrinkwrap_introduction_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
                  <a href="/guides/shrinkwrap_introduction_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
                  <a href="/guides/shrinkwrap_introduction_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                </dl>
                <dl class="int">
                  <dt>More Coverage</dt>
                  <dd><a href="/guides/testing_java_persistence/">Testing Java Persistence</a>
                  <br />
                  <a href="/guides/testing_java_persistence/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/testing_java_persistence_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/testing_java_persistence_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
                  <a href="/guides/testing_java_persistence_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/testing_java_persistence_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/testing_java_persistence_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                  <dd><a href="/guides/functional_testing_using_graphene/">Functional Testing using Drone and Graphene</a></dd>
                  <dd><a href="/guides/testing_in_the_cloud/">Testing in the Cloud</a></dd>
                </dl>
                <dl class="adv">
                  <dt>Enhance</dt>
                  <dd><a href="/guides/developing_a_container_adapter/">Developing a Container Adapter</a></dd>
                </dl>
                <dl class="ref">
                  <dt>Reference</dt>
                  <dd><a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Reference Guide</a></dd>
                  <dd><a href="http://docs.jboss.org/arquillian/aggregate/latest">API &amp; SPI Docs</a></dd>
                  <dd><a href="http://community.jboss.org/wiki/ArquillianMigrationGuides">Migration Guides</a></dd>
                  <dd><a href="http://community.jboss.org/en/arquillian/faq">FAQs</a></dd>
                </dl>
              </div>
            </div>
            <script>$(function() { activateGuideMenuControl() })</script>
          </div>
        </div>
      </div>
      <div class="container" id="guide">
        <div id="content">
            <div class="header">
            <div class="titlebar">
            <h2>Developing a Container Adapter</h2>
            <div class="btn-group">
              <a class="btn" href="https://github.com/arquillian/arquillian.github.io/edit/develop/guides/developing_a_container_adapter.textile">Edit this file</a>
            </div>
          </div>
            <div class="authors"><strong>Author:</strong>
          <a href="/community/vineetreynolds">Vineet Reynolds</a>  <br />
          <strong>Level:</strong>
          Enhance  <strong style="padding-left: 10px;">Tags:</strong>
          containers, spi, extension  <strong style="padding-left: 10px;">Last Update:</strong>Jun 19, 2017</div>
            <p>This guide introduces you to Arquillian&#8217;s Container SPI for the purpose of developing a new container adapter. After reading this guide, you&#8217;ll be able to:</p>
            <ul>
          	<li>Write your own Arquillian container adapter</li>
          	<li>Add support for select programming models in tests</li>
          	<li>Test an Arquillian extension</li>
          	<li>Use the container adapter to run tests in the new container</li>
          </ul>
            <p>You&#8217;ll learn all of these skills by creating an Arquillian extension project that has a Maven build. We&#8217;ve designed this guide to be a <em>fast read</em> to get you started quickly!</p>
            </div>
            <h3 id="assumptions">Assumptions</h3>
          <p>This guide assumes you are familiar with using Arquillian. You should understand the basic building blocks of Arquillian, how to set it up and how to develop and execute tests. If you don&#8217;t, you&#8217;ll have better chance of success by first reviewing the two starter guides, <a href="/guides/getting_started">Getting Started</a> and <a href="/guides/getting_started_rinse_and_repeat">Getting Started: Rinse and Repeat</a>.</p>
          <p>Obviously, you should be familiar with the container for which you are writing an adapter, specifically its deployment mechanism and/or API. It also helps to understand Arquillian&#8217;s event model.</p>
          <p>Finally, this guide assumes you are familiar with Maven. All the reference container adapters provided by Arquillian are organized as Maven projects and we will be following that lead in this guide.</p>
          <h3 id="what_is_a_container_adapter">What is a Container Adapter?</h3>
          <p>A container, generally speaking, is a runtime with which Arquillian interacts when running a test. Arquillian may manage the container&#8217;s lifecycle or simply bind to it. Arquillian may deploy archives or descriptors to the container. Arquillian may transfer execution of the tests into the container, or it may simply make the URL of the deployed application available to the test which is acting as a client. What&#8217;s important is that the container interaction is transparent to the test.</p>
          <p>To recollect a few salient points from the getting started guides, Arquillian supports containers through its extension mechanism. A container adapter is packaged as a JAR and is referenced, along with its dependencies, through as set of Maven coordinates (groupId, artifactId, version). During the execution of tests, a container adapter must be present in the test classpath, allowing Arquillian to locate, load and use it.</p>
          <p>The notion of a container is not restricted to a Servlet container, an EJB container or a Java EE container, despite these being the most common types. A container could be abstracted away as a JVM process (like most Servlet containers and Java EE containers), a cloud service provider (OpenShift and CloudBees) or even a device (Android). Simply put, a container adapter enables Arquillian to communicate with a container so that the test doesn&#8217;t have to.</p>
          <h4>How a container adapter gets discovered</h4>
          <p>Container adapters are Arquillian extensions located using the Service Provider Interface (SPI) mechanism in Java. All Arquillian container adapter extensions must implement the <code>LoadableExtension</code> SPI. The <code>LoadableExtension</code> of a container is used to register a <code>DeployableContainer</code> service. A container adapter implements the <code>DeployableContainer</code> SPI in a manner specific to the container, to enable Arquillian to manage the lifecycle, make deployments and to execute tests in the container.</p>
          <h3 id="setup_the_project">Setup the Project</h3>
          <p>One must first create a new project (preferably in Maven) to compile and package the container adapter.</p>
          <p class="info"><span>Arquillian container adapters are usually created with the groupId of <code>org.jboss.arquillian.container</code> , and with an artifactId of <code>arquillian-{container_acronym}-{managed|remote|embedded}-{container_version}</code>.</span></p>
          <p>Update the project POM with the following necessary dependencies.</p>
          <div class="filename">pom.xml</div>
          <pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependencyManagement&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt;&#x000A;            &lt;version&gt;${version.arquillian_core}&lt;/version&gt;&#x000A;            &lt;type&gt;pom&lt;/type&gt;&#x000A;            &lt;scope&gt;import&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/dependencyManagement&gt;</code>&#x000A;&#x000A;<code class="prettify">&lt;dependencies&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-container-spi&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-container-test-spi&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;&#x000A;&lt;/dependencies&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
          <p>The <code>version.arquillian_core</code> property in the above snippet should match the  version of Arquillian Core that the adapter would be tested and built against.</p>
          <p>Additional dependencies will be added in later sections.</p>
          <h3 id="write_the_extension">Write the Extension</h3>
          <h4>Implement the DeployableContainer</h4>
          <p>The <code>DeployableContainer</code> implementation is the heart of a container adapter. Arquillian invokes the methods on the <code>DeployableContainer</code> during various points in the test lifecycle. The table below lists the significance of some of these methods:</p>
          <table>
          	<tr>
          		<td> setup(T configuration) </td>
          		<td> Sets up the <code>DeployableContainer</code> instance. </td>
          	</tr>
          	<tr>
          		<td> start() </td>
          		<td> Starts the container. Invoked before the test suite or class begins. Can be invoked manually via a <code>ContainerController</code>. </td>
          	</tr>
          	<tr>
          		<td> stop() </td>
          		<td> Stops the container. Invoked after the test suite or class ends. Can be invoked manually via a <code>ContainerController</code>. </td>
          	</tr>
          	<tr>
          		<td> deploy(org.jboss.shrinkwrap.api.Archive&lt;?&gt; archive) </td>
          		<td> Deploys an archive. Invoked before all test methods in a test class. </td>
          	</tr>
          	<tr>
          		<td> undeploy(org.jboss.shrinkwrap.api.Archive&lt;?&gt; archive) </td>
          		<td> Undeploys an archive. Invoked after all the test methods in a test class. </td>
          	</tr>
          	<tr>
          		<td> deploy(org.jboss.shrinkwrap.descriptor.api.Descriptor descriptor) </td>
          		<td> Deploys a descriptor (data source, JMS queue, etc). Executed before all the test methods in a test class. </td>
          	</tr>
          	<tr>
          		<td> undeploy(org.jboss.shrinkwrap.descriptor.api.Descriptor descriptor) </td>
          		<td> Undeploys a descriptor. Executed after all the test methods in a test class. </td>
          	</tr>
          </table>
          <h4>Implement the ContainerConfiguration</h4>
          <p>The <code>ContainerConfiguration</code> type is a JavaBean-style class that is used to store properties required to assist in the operation of the container adapter. A container adapter creates a concrete implementation of this type. The properties are set by Arquillian from the arquillian.xml configuration file, arquillian.properties file or from commandline arguments. Note that Arquillian can set values for datatypes like Strings, Booleans, Integers etc. Complex properties are initialized to null even though their values may be provided.</p>
          <p>You can validate the supplied property values in the <em>validate</em> method of the <code>ContainerConfiguration</code> type.</p>
          <p>Once you have defined a <code>ContainerConfiguration</code> class for a container adapter, you must register it in the <code>getConfigurationClass</code> method of the <code>DeployableContainer</code> class of the adapter, like:</p>
          <pre class="prettify"><code class="prettify">public class MyDeployableContainer implements DeployableContainer&lt;MyContainerConfiguration&gt; {&#x000A;    @Override&#x000A;    public Class&lt;MyContainerConfiguration&gt; getConfigurationClass() {&#x000A;        return MyContainerConfiguration.class;&#x000A;    }&#x000A;}</code></pre>
          <h4>Choose the protocol</h4>
          <p>An Arquillian protocol is the means employed by Arquillian to communicate with the container and to coordinate the execution of tests and collection of test results. Arquillian provides implementations out of the box for several protocols: JMX, Servlet 2.5 and Servlet 3.0. Note that the JMX protocol provided by Arquillian Core is an abstract protocol requiring a concrete implementation to be provided by the container adapter; one can refer the JBoss AS7 Arquillian container adapter for a real-world implementation. You can also implement custom protocols, however it&#8217;s beyond the scope of this guide.</p>
          <p>The default protocol used by Arquillian to communicate with the container is determined primarily by the container adapter, though can be overriden in arquillian.xml or for a specific deployment through the <code>@OverProtocol</code> annotation. Choosing the correct protocol is important since the choice is primarily driven by the capabilities of the container. Most Java EE 6 container adapters specify a default protocol of <em>Servlet 3.0</em>, whereas Java EE 5 container adapters specify a default protocol of <em>Servlet 2.5</em>.</p>
          <p class="info"><span>The &#8220;Servlet 2.5&#8221; and &#8220;Servlet 3.0&#8221; strings are unique names identifying the protocol. Arquillian uses this information at runtime to enhance deployments with the test runners and communication endpoints required for the protocol.</span></p>
          <p>The snippet below shows how to configure the <em>Servlet 3.0</em> protocol for your container adapter.</p>
          <pre class="prettify"><code class="prettify">// clip&#x000A;@Override&#x000A;public ProtocolDescription getDefaultProtocol() {&#x000A;    return new ProtocolDescription("Servlet 3.0");&#x000A;}&#x000A;// clip</code></pre>
          <p>You must also add the project containing the protocol implementation as a Maven dependency to your container adapter project. This will establish the protocol implementation as a transitive dependency for your container. The following snippet shows the addition of the <code>arquillian-protocol-servlet</code> artifact to support the Servlet protocol.</p>
          <div class="filename">pom.xml</div>
          <pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependencies&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-protocol-servlet&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;&#x000A;&lt;/dependencies&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
          <h4>Implement the lifecycle APIs for your adapter</h4>
          <p><strong>Setup method</strong></p>
          <p>The <code>setup(T configuration)</code> method is invoked by Arquillian after initializing the <code>DeployableContainer</code> instance. An instance of the <code>ContainerConfiguration</code> class associated with the container adapter is populated with user-supplied properties, validated, and provided as an argument to this method.</p>
          <pre class="prettify"><code class="prettify">// clip&#x000A;private MyContainerConfiguration config;</code>&#x000A;&#x000A;<code class="prettify">@Override&#x000A;public void setup(MyContainerConfiguration configuration) {&#x000A;    this.configuration = configuration;&#x000A;}&#x000A;// clip</code></pre>
          <p>Method implementations are often limited to storing the <code>ContainerConfiguration</code> argument for future use by the container adapter in other parts of the adapter lifecycle, as shown in the above snippet.</p>
          <p><strong>Start method</strong></p>
          <p>The <code>start()</code> method is invoked by Arquillian to signal the initialization of the container adapter. When this method returns, the container adapter is required to be ready to process deployments and test executions.</p>
          <p>If you are implementing an embedded or a managed Arquillian container adapter, this is the place to start the container. In the case of remote container adapters, this is ideally the place to verify if the container is running, along with any other necessary validations.</p>
          <p class="info"><span>In Arquillian, an embedded container runs in the same JVM as the client initiating the test. A managed container refers to one where Arquillian manages the entire lifecycle of the container. Managed container adapters usually fork a new process to operate the container, eventually terminating the process after all tests have been executed. A remote container refers to one where the lifecycle of the container is not managed by Arquillian. In this scenario, management of the remote container is often delegated to the build script and Arquillian is only responsible for deployment and execution of tests.</span></p>
          <p><strong>Stop method</strong></p>
          <p>The <code>stop()</code> method is invoked by Arquillian to signal the termination of the container adapter. Any cleanup operations can be performed in this method.</p>
          <p>It is possible for Arquillian to restart container adapters, especially in the case of managed containers. This is typically done to ensure that the managed JVM does not run out of space in it&#8217;s permanent generation. Therefore, one must not assume that the <em>start</em> and <em>stop</em> methods will be invoked exactly once in a test suite; they may be invoked multiple times with every start followed by an equivalent stop.</p>
          <h4>Implement the archive deployment APIs</h4>
          <p><strong>Archive deploy method</strong></p>
          <p>This <code>deploy(Archive&lt;?&gt; archive)</code> method is responsible for deploying the supplied archive to the target container. This is done in a manner proprietary to the container. Some containers may require a multi-part HTTP POST request to be submitted, some may require files to be placed in a certain directory and some require proprietary APIs to be invoked. This is where familiarity with your container is critical.</p>
          <p>This <code>deploy(Archive&lt;?&gt; archive)</code> method returns an instance of <code>ProtocolMetaData</code> upon completion. The container adapter must introspect the container to obtain the necessary metadata used to construct the <code>ProtocolMetaData</code> instance. In the case of the Servlet protocol, the <code>ProtocolMetaData</code> contains the context root of the deployment, as well as the list of all Servlets under the context root. When this method returns, it is expected that the deployment can be reached via the information in the <code>ProtocolMetaData</code> object.</p>
          <p><strong>Archive undeploy method</strong></p>
          <p>The <code>undeploy(Archive&lt;?&gt; archive)</code> method is responsible for undeploying the previously deployed archive from the target container. Like the <code>deploy(Archive&lt;?&gt; archive)</code> method, this is done in a manner proprietary to the container.</p>
          <h4>Optionally, implement the descriptor deployment APIs</h4>
          <p><strong>Descriptor deploy method</strong></p>
          <p>This <code>deploy(Descriptor descriptor)</code> method allows for deployment of descriptors. Simply put, deployment of descriptors allows for creation of datasources, JMS queues and other ressources on the container that will be used only for the duration of the test. Note that the <code>Descriptor</code> type hierarchy is not formalized. Every container adapter is free to implement its own <code>Descriptor</code> classes.</p>
          <p><strong>Descriptor undeploy method</strong></p>
          <p>The <code>undeploy(Descriptor descriptor)</code> method is the converse of the <code>deploy(Descriptor descriptor)</code> method for descriptors. It allows for undeployment of resources after test execution.</p>
          <h4>Add the test enrichers</h4>
          <p>Arquillian supports dependency injection for both in-container and client tests through the use of Arquillian test enrichers. Which injections are supported depend on the type of test and the capabilities of the container. Injection points (e.g., fields in the test class or arguments to test methods) can be annotated with <code>@Resource</code>, <code>@EJB</code>, <code>@Inject</code>, <code>@PersistenceContext</code> annotations, instructing Arquillian to inject these dependencies at runtime.</p>
          <p>In order to support these annotations, the deployed archive must be enhanced with the Arquillian test enrichers. Additionally, a container may support only certain test enrichers natively. For instance, Java EE 5 containers may not support injection of <code>@Inject</code> annotated dependencies out of the box, while a Servlet container adapter (like Tomcat) would not support injection of <code>@EJB</code> annotated dependencies.</p>
          <p>A container adapter declares the default set of test enrichers as classpath dependencies; at runtime, the test enrichers are made available as transitive dependencies of the container adapter. The test enricher projects contain the necessary auxiliary archive appenders that would enhance a deployment with the required set of classes and resources. Depending on the supported test enrichers, add one or all of the dependencies listed below, to your container adapter project.</p>
          <div class="filename">pom.xml</div>
          <pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependencies&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;!-- For @Inject annotations --&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.testenricher&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-testenricher-cdi&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;!-- For @EJB annotations --&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.testenricher&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-testenricher-ejb&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;!-- For @Resource annotations --&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.testenricher&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-testenricher-resource&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;!-- For @ArquillianResource annotated InitialContext injection points --&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.testenricher&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-testenricher-initialcontext&lt;/artifactId&gt;&#x000A;    &lt;/dependency&gt;</code>&#x000A;&#x000A;<code class="prettify">&lt;/dependencies&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
          <p>By including the dependencies as shown in the above snippet, the following extensions would be discovered by Arquillian at the time of test execution:</p>
          <ul>
          	<li><code>CDIEnricherExtension</code></li>
          	<li><code>EJBEnricherExtension</code></li>
          	<li><code>ResourceEnricherExtension</code></li>
          	<li><code>InitialContextExtension</code></li>
          </ul>
          <p>The associated <code>AuxiliaryArchiveAppender</code> implementations in these extensions would enhance the deployment with the test enrichers and associated dependencies. The <code>TestEnricher</code> implementations in these extensions would also be registered as service providers that can be discovered in-container. When a test class instance is to be enriched (before execution of the contained tests), the registered test enrichers (that have been deployed alongside the test) will be used to discover and inject dependencies into the instance.</p>
          <h3 id="register_the_extension">Register the Extension</h3>
          <p>To wire up the container adapter together, create a new Arquillian extension by implementing the <code>LoadableExtension</code> interface in your project. The extension must register the concrete implementation of <code>DeployableContainer</code> as a service. In the following snippet, a <code>LoadableExtension</code> is created that registers the <code>MyDeployableContainer</code> type as a <code>DeployableContainer</code>.</p>
          <pre class="prettify"><code class="prettify">public class MyContainerExtension implements LoadableExtension {&#x000A;    @Override&#x000A;    public void register(ExtensionBuilder builder) {&#x000A;        builder.service(DeployableContainer.class, MyDeployableContainer.class);&#x000A;    }&#x000A;}</code></pre>
          <p>Finally, the container adapter extension needs to be registered using the SPI registration mechanism. You must create a file named org.jboss.arquillian.core.spi.LoadableExtension as shown below and put the fully qualified class name of the class implementing the <code>LoadableExtension</code> SPI on the first line.</p>
          <div class="filename">src/main/resources/META-INF/services/org.jboss.arquillian.core.spi.LoadableExtension</div>
          <pre class="prettify"><code class="prettify">org.jboss.arquillian.container.guide.spi.MyContainerExtension</code></pre>
          <h3 id="write_the_tests">Write the Tests</h3>
          <p>While one can write a container adapter without tests, this is certainly not advisable. Tests can not only serve to define the expected behavior of the adapter, but also serve as useful examples for using the adapter. Generally, tests are written to cover the following areas:</p>
          <ul>
          	<li>Deployment of various types of ShrinkWrap archives: JavaArchive, WebArchive and EnterpriseArchive.</li>
          	<li>Execution of tests run at the client, using the <code>@RunAsClient</code> annotation and injection of dependencies into such tests using the <code>@ArquillianResource</code> annotation.</li>
          	<li>Execution of tests run in-container and injection of dependencies into such tests using the supported annotations.</li>
          </ul>
          <h3 id="share">Share the Knowledge</h3>
          <p>Find this guide useful?</p>
          <p class="post_to_twitter"><a href="http://twitter.com/home/?status=Just%20read%20the%20%23Arquillian%20Developing%20a%20Container%20Adapter%20guide%20and%20got%20a%20%23greenbar!%20Get%20yours.%20http://arquillian.org/guides/developing_a_container_adapter/"><img src="/images/post_to_twitter.png" alt="" /></a></p>
          <div class="g-plusone" data-size="tall"></div>
          <p>There&#8217;s a lot more about Arquillian to cover. If you&#8217;re ready to learn more, check out the <a href="/guides">other available guides</a>.</p>
          <h4>Feedback</h4>
          <p>Find a bug in the guide? Something missing? You can fix it by <a href="http://github.com/arquillian/arquillian.github.com">forking this website</a>, making the correction and <a href="http://help.github.com/send-pull-requests">sending a pull request</a>. If you&#8217;re just plain stuck, feel free to ask a question in the <a href="http://community.jboss.org/en/arquillian?view=discussions">user discussion forum</a>.</p>
          <h4>Recent Changelog</h4>
          <ul>
            <li>
              Jun 19, 2017:
              Fix: fixed restore_cache script to make it runnable from any location
              <em>by Matous Jobanek</em>
            </li>
          </ul>
          <p>
            <a href="https://github.com/arquillian/arquillian.github.io/commits/develop/guides/developing_a_container_adapter.textile">See full history &raquo;</a>
          </p>
        </div>
        <div id="sidebar">
          <div id="toc">
            <h3 class="chapter_header">Chapters</h3>
            <ol class="chapters">
              <li>
                <a href="#assumptions" id="assumptions_link">Assumptions</a>
              </li>
              <li>
                <a href="#what_is_a_container_adapter" id="what_is_a_container_adapter_link">What is a Container Adapter?</a>
              </li>
              <li>
                <a href="#setup_the_project" id="setup_the_project_link">Setup the Project</a>
              </li>
              <li>
                <a href="#write_the_extension" id="write_the_extension_link">Write the Extension</a>
              </li>
              <li>
                <a href="#register_the_extension" id="register_the_extension_link">Register the Extension</a>
              </li>
              <li>
                <a href="#write_the_tests" id="write_the_tests_link">Write the Tests</a>
              </li>
              <li>
                <a href="#share" id="share_link">Share the Knowledge</a>
              </li>
            </ol>
          </div>
        </div>
        <script>
          $(window).load(function() { activateScrollingToc(['assumptions', 'what_is_a_container_adapter', 'setup_the_project', 'write_the_extension', 'register_the_extension', 'write_the_tests', 'share']) })
        </script>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="project">
          <img src="/images/arquillian_logo_200px.png" />
          <p class="bottom">
            &#169;
            Copyright 2009-2017 Red Hat, Inc.
            <br />
            <i class="icon-fire"></i>
            Mixed with <a href="http://twitter.github.com/bootstrap">Bootstrap</a>. Baked by <a href="http://awestruct.org">Awestruct</a>.
            <br />
            <i class="icon-share-alt"></i>
            Website and docs licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.
            <br />
            Code released under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, v2.0</a>.
          </p>
        </div>
        <div class="footer-nav">
          <h4>Learn</h4>
          <ul>
            <li>
              <a href="/invasion">Mission</a>
            </li>
            <li>
              <a href="/features">Features</a>
            </li>
            <li>
              <a href="/docs">Documentation</a>
            </li>
            <li>
              <a href="/guides">Guides</a>
            </li>
            <li>
              <a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Manual</a>
            </li>
            <li>
              <a href="http://community.jboss.org/en/arquillian/faq">FAQs</a>
            </li>
          </ul>
        </div>
        <div class="footer-nav">
          <h4>Get Involved</h4>
          <ul>
            <li>
              <a href="http://community.jboss.org/en/arquillian?view=discussions">Forums</a>
            </li>
            <li>
              <a href="https://issues.jboss.org/browse/ARQ">Issue Tracker</a>
            </li>
            <li>
              <a href="https://github.com/arquillian">Source Code</a>
            </li>
            <li>
              <a href="/community/contributors">Contributors</a>
            </li>
            <li>
              <a href="https://community.jboss.org/groups/testing">Testing SIG</a>
            </li>
          </ul>
        </div>
        <div class="sponser">
          <div class="follow-us">
            <h4>Stay Informed</h4>
            <ul>
              <li>
                <a href="https://plus.google.com/100660127586085393031?rel=author"><img alt="Google+" src="/images/social/googleplus-16.png" title="Follow Arquillian on Google+" /></a>
              </li>
              <li>
                <a href="https://twitter.com/#!/search/%23arquillian"><img alt="Twitter" src="/images/social/twitter-16.png" title="Browse the #arquillian hashtag on Twitter" /></a>
              </li>
              <li>
                <a href="http://www.linkedin.com/groups?gid=3120340"><img alt="LinkedIn" src="/images/social/linkedin-16.png" title="Join the Arquillian group on LinkedIn" /></a>
              </li>
              <li>
                <a href="http://vimeo.com/channels/arquillian"><img alt="Vimeo" src="/images/social/vimeo-16.png" title="Follow the Arquillian channel on Vimeo" /></a>
              </li>
            </ul>
          </div>
          <p>This website is open source! If you want to improve it, <a href="http://github.com/arquillian/arquillian.github.com">fork the project</a>, hack on it, then send a <a href="https://help.github.com/articles/using-pull-requests">pull request</a>. You can also view the <a href="http://www.seethestats.com/site/arquillian.org">visitor stats</a>.</p>
          <p class="image"><a href="http://jboss.org"><img src="/images/jboss_redhat_branding.png" class="branding" title="Red Hat, Inc." alt="Red Hat, Inc." /></a></p>
          <p>Arquillian is a <a href="http://jboss.org">JBoss Community</a> project and development is sponsored by Red Hat, Inc.</p>
          <p class="bottom"><a href="http://www.redhat.com/legal/legal_statement.html">Terms of Use</a> | <a href="http://www.redhat.com/legal/privacy_statement.html">Privacy Policy</a></p>
        </div>
        <a class="visible-desktop" href="#" id="toTop">Top</a>
      </div>
    </footer>
    <script>
      $(function() {
        $('html').addClass('ready');
        prettify();
        activateFooterGravity();
        activateTooltips();
        activateToTopControl();
      });
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.0.2/bootstrap.min.js"></script>
    <script src="/javascripts/prettify.js"></script>
    <script src="/javascripts/site.js?a64be9bfe706fa7c6bf4dafe5217e75bf594d112"></script>
    <script src="/javascripts/jquery-scroll.js"></script>
    <script src="http://apis.google.com/js/plusone.js"></script>
    <script>
      (function() {
        var po = document.createElement('script'); po.async = true; po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount','UA-18727998-3']);
    _gaq.push(['_trackPageview']);
    (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </body>
</html>
