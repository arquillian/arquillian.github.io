<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Démarrage Rapide &#183; Arquillian Guides</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="Apprenez comment ajouter Arquillian aux tests d'intégration de votre projet et comment écrire votre premier test Arquillian." name="description" />
    <link href="/blog/atom.xml" rel="alternate" title="Arquillian blog Atom feed" type="application/atom+xml" />
    <link href="/stylesheets/screen.css?21bb5f0abb4b7a462f428eace2953d7cc2b63046" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.js"></script>
    <![endif]-->
    <link href="/favicon.ico" rel="shortcut icon" />
  </head>
  <body class="guide">
    <header class="navbar navbar-fixed-top" id="banner" role="banner">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <div class="g-plusone-slot">
            <div class="g-plusone" data-annotation="none"></div>
          </div>
          <a class="brand" href="/">
            <span class="logo"></span>
            <span class="name">Arquillian</span>
          </a>
          <nav class="nav-collapse" role="navigation">
            <ul class="nav">
              <li><a href="/invasion/">Invasion!</a></li>
              <li><a href="/features/">Features</a></li>
              <li class="active"><a href="/guides/">Guides</a></li>
              <li><a href="/blog/">Blog</a></li>
              <li><a href="/community/">Community</a></li>
              <li><a href="/code/">Code</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>
    <div id="main" role="main">
  <div id="content-header">
    <div class="container">
      <div class="headline">
        <h1>
          <a href="/guides/">Arquillian Guides</a>
          <small>Designed exclusively to teach you how to use Arquillian to write real tests.</small>
        </h1>
        <div class="directory">
          <a class="guides_menu" href="./" id="guides_menu">
            Guides Index
            <i class="icon-menu-closed"></i>
          </a>
          <div id="guides" style="display: none">
            <a class="guides_menu" href="./">
              Guides Index
              <i class="icon-menu-open"></i>
            </a>
            <hr class="clear" />
            <dl class="beg">
              <dt>First Steps</dt>
              <dd><a href="/guides/getting_started/">Getting Started</a>
              <br />
              <a href="/guides/getting_started/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
              <a href="/guides/getting_started_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
              <a href="/guides/getting_started_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
              <a href="/guides/getting_started_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
              <a href="/guides/getting_started_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
              <a href="/guides/getting_started_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
              <a href="/guides/getting_started_nl/"><img class="flag" rel="tooltip" src="/images/flags/nl.png" title="Nederlands (nl)" /></a>
              <a href="/guides/getting_started_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
              <a href="/guides/getting_started_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
              <a href="/guides/getting_started_sv_se/"><img class="flag" rel="tooltip" src="/images/flags/sv_se.png" title="Svenska (sv_se)" /></a>
              <a href="/guides/getting_started_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
              <dd><a href="/guides/getting_started_rinse_and_repeat/">Getting Started: Rinse and Repeat</a>
              <br />
              <a href="/guides/getting_started_rinse_and_repeat/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
              <a href="/guides/getting_started_rinse_and_repeat_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
              <a href="/guides/getting_started_rinse_and_repeat_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
              <a href="/guides/getting_started_rinse_and_repeat_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
              <a href="/guides/getting_started_rinse_and_repeat_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
              <a href="/guides/getting_started_rinse_and_repeat_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
              <a href="/guides/getting_started_rinse_and_repeat_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
              <dd><a href="/guides/get_started_faster_with_forge/">Get Started Faster with Forge</a>
              <br />
              <a href="/guides/get_started_faster_with_forge/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
              <a href="/guides/get_started_faster_with_forge_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
              <a href="/guides/get_started_faster_with_forge_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
              <a href="/guides/get_started_faster_with_forge_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
              <a href="/guides/get_started_faster_with_forge_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
              <dd><a href="/guides/shrinkwrap_introduction/">Creating Deployable Archives with ShrinkWrap</a>
              <br />
              <a href="/guides/shrinkwrap_introduction/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
              <a href="/guides/shrinkwrap_introduction_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
              <a href="/guides/shrinkwrap_introduction_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
            </dl>
            <dl class="int">
              <dt>More Coverage</dt>
              <dd><a href="/guides/testing_java_persistence/">Testing Java Persistence</a>
              <br />
              <a href="/guides/testing_java_persistence/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
              <a href="/guides/testing_java_persistence_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
              <a href="/guides/testing_java_persistence_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
              <a href="/guides/testing_java_persistence_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
              <dd><a href="/guides/functional_testing_using_drone/">Functional Testing using Drone</a></dd>
            </dl>
            <dl class="adv">
              <dt>Enhance</dt>
              <dd><a href="/guides/testing_in_the_cloud/">Testing in the Cloud</a></dd>
            </dl>
            <dl class="ref">
              <dt>Reference</dt>
              <dd><a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Reference Guide</a></dd>
              <dd><a href="http://docs.jboss.org/arquillian/api/latest">API Docs</a>,
              <a href="http://docs.jboss.org/arquillian/spi/latest">SPI Docs</a></dd>
              <dd><a href="http://community.jboss.org/wiki/ArquillianMigrationGuides">Migration Guides</a></dd>
              <dd><a href="http://community.jboss.org/en/arquillian/faq">FAQs</a></dd>
            </dl>
          </div>
        </div>
        <script>$(function() { activateGuideMenuControl() })</script>
      </div>
    </div>
  </div>
  <div class="container" id="guide">
    <div id="content" lang="fr">
            <div class="header">
            <div class="titlebar">
    <h2>Démarrage Rapide</h2>
    <div class="btn-group">
      <a class="btn" href="https://github.com/arquillian/arquillian.github.com/edit/develop/guides/getting_started_fr.textile">Edit this file</a>
    </div>
  </div>
            <div class="authors"><strong>Author:</strong>
   <a href="https://community.jboss.org/people/dan.j.allen">Dan Allen</a>
  <strong style="padding-left: 10px;">Translators:</strong>
   <a href="https://community.jboss.org/people/badr">Badr El Houari</a>, <a href="https://community.jboss.org/people/antoinesabot-durand">Antoine Sabot-durand</a>, <a href="https://community.jboss.org/people/sewatech">Alexis Hassler</a>
  <strong style="padding-left: 10px;">Language:</strong>
  <img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" />
  <br />
  <strong style="padding-left: 0px;">Tags:</strong>
   cdi, weld, maven, forge, eclipse
  <strong style="padding-left: 10px;">Last Update:</strong> Apr 29, 2012</div>
            <p>Ce guide a pour objectif de vous initier à Arquillian. Après la lecture de ce document nous espérons que vous serez capable de:</p>
            <ul>
	<li>Ajouter Arquillian et son environnement d&#8217;exécution à un projet Java basé sur Maven</li>
	<li>Ecrire un cas de test (test case) avec Arquillian afin d&#8217;affirmer (assert) le comportement d&#8217;un bean CDI (Contexts and Dependency Injection)</li>
	<li>Exécuter le test dans plusieurs conteneurs.</li>
</ul>
            <p>Vous apprendrez tout ça en ajoutant Arquillian dans les séries de test de votre application Java EE avec un build Maven. Nous avons conçu ce guide pour que vous puissiez commencer très rapidement !</p>
            </div>
            <h3 id="hypoth&#232;ses">Hypothèses</h3>
<p>La façon la plus simple pour démarrer avec Arquillian consiste à l&#8217;intégrer à une série de tests (test suite) dans un projet disposant d&#8217;une gestion de dépendances. Actuellement l&#8217;outil le plus connu de cette catégorie est <a href="http://maven.apache.org">Apache Maven</a>. Ce guide vous accompagnera dans la réalisation de votre premier projet Maven <strong class="greenbar">barre verte</strong> .</p>
<p class="info"><span>Arquillian ne dépend pas de maven, ni d&#8217;autres outils de build. Il est facilement intégrable avec les projets utilisant Ant ou Gradle comme outils de build. Idéalement, l&#8217;outil pour le build doit offrir une gestion de dépendances afin de simplifier l&#8217;ajout des librairies d&#8217;Arquillian puisqu&#8217;ils sont disponibles dans le <a href="http://search.maven.org">Maven Central repository</a></span></p>
<p>Ce guide suppose que vous disposiez déjà de Maven,soit en ligne de commande ou dans votre IDE (Environnement de développement intégré). Si ce n&#8217;est pas le cas, <a href="http://maven.apache.org/download.html">installez le maintenant</a>. Vous aurez besoin aussi du <a href="http://www.oracle.com/technetwork/java/javase/downloads"><acronym title="Java Development Kit">JDK</acronym> 1.5</a> installé dans votre machine.</p>
<h3 id="cr&#233;er_un_nouveau_projet">Créer un nouveau projet</h3>
<p>Nous nous recommandons deux façons pour créer votre nouveau projet Maven:</p>
<ol>
	<li><a href="#generate_project_from_archetype">Générer un projet à partir d&#8217;un archétype Maven</a></li>
	<li><a href="#create_project_using_forge">Créer et personnaliser un projet en utilisant JBoss Forge</a></li>
</ol>
<p>Actuellement <a href="http://jboss.org/forge">JBoss Forge</a> est l&#8217;approche la plus simple, toutefois, ce guide vous proposera les deux options si vous n&#8217;êtes pas encore prêt à adopter JBoss Forge. Choisissez l&#8217;une des deux options ci dessus pour vous rendre directement aux instructions.</p>
<p class="info"><span>Si vous disposez déjà d&#8217;un projet Maven, cette section vous servira pour vérifier si vous avez les bonnes dépendances avant d&#8217;aller plus loin!.</span></p>
<h4 id="generate_project_from_archetype">Générez un projet à partir d&#8217;un archétype Maven</h4>
<p>Tout d&#8217;abord, créez un projet java avec Maven en utilisant la commande ci dessous.</p>
<pre class="command"><code class="command">$ mvn archetype:generate -DarchetypeGroupId=net.avh4.mvn.archetype \&#x000A;-DarchetypeArtifactId=java-1.6-archetype</code></pre>
<p><em>Copiez le texte après <code>$</code> et collez le dans votre shell.</em> Répondez aux questions en saisissant les valeurs indiquées ci-dessous après chaque paire de deux points puis validez (comme indiqué par <code>&lt;ENTER&gt;</code>).</p>
<pre class="output"><code class="output">&#x000A;Définir la valeur pour la propriété (Define value for property) 'groupId': : org.arquillian.example &lt;ENTER&gt;&#x000A;Define value for property 'artifactId': : arquillian-tutorial &lt;ENTER&gt;&#x000A;Define value for property 'version': : &lt;ENTER&gt;&#x000A;Define value for property 'package': : &lt;ENTER&gt;&#x000A;Confirmer cette configuration des propriétés (Confirm properties configuration):&#x000A;groupId: org.arquillian.example&#x000A;artifactId: arquillian-tutorial&#x000A;version: 1.0-SNAPSHOT&#x000A;package: org.arquillian.example&#x000A;Y: : &lt;ENTER&gt;</code></pre>
<p>Cette commande génère un projet Java basé sur Maven dans un nouveau dossier du répertoire courant, avec <code>arquillian-tutorial</code> comme nom. Ci-dessous la structure des fichiers du projet:</p>
<ul class="filetree">
	<li>src/
	<ul>
		<li>main/
		<ul>
			<li>java/ &#8211; Placez tous les fichiers du code source java ici (sous forme de packages Java)</li>
			<li>resources/ &#8211; Placez tous les fichiers de configuration de votre application ici</li>
		</ul></li>
		<li>test/
		<ul>
			<li>java/ &#8211; Placez toutes les classes de test ici (sous forme de packages java)</li>
			<li>resources/ &#8211; Placez tous les fichiers de configuration des tests ici (i.e. arquillian.xml)</li>
		</ul></li>
	</ul></li>
	<li>pom.xml &#8211; Le fichier Maven pour le build. Indique à Maven comment votre projet doit être construit.</li>
</ul>
<p class="info"><span>Le projet est pré-configuré pour utiliser Java 1.6 et JUnit 4.8, ce sont les versions minimum requises pour pouvoir utiliser Arquillian.</span></p>
<p>Le générateur crée aussi un package Java <code>org.arquillian.example</code>. Vous devez alors mettre vos classes Java sous ce package au lieu de les mettre à la racine du répertoire <code>java</code>.</p>
<p class="warning"><span>Notez qu&#8217;Arquillian supporte aussi TestNG 5 même si tout au long de ce guide nous utiliserons uniquement JUnit</span></p>
<p>Ouvrez le fichier <code>pom.xml</code> avec votre éditeur préféré. Il s&#8217;agit d&#8217;un fichier XML contenant une configuration de base pour votre projet, une section pour le build et une autre pour les dépendances. <strong>Tout les éléments <code>&lt;dependency&gt;</code> sous JUnit ne sont pas obligatoires, vous pouvez donc les supprimer.</strong></p>
<p>Après avoir effectué ce changement, vous devez obtenir le contenu suivant:</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;?xml version="1.0" encoding="UTF-8"?&gt;&#x000A;&lt;project xmlns="http://maven.apache.org/POM/4.0.0"&#x000A;    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&#x000A;    xsi:schemaLocation="&#x000A;        http://maven.apache.org/POM/4.0.0&#x000A;        http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;&#x000A;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;groupId&gt;org.arquillian.example&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;arquillian-tutorial&lt;/artifactId&gt;&#x000A;    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&#x000A;    &lt;packaging&gt;jar&lt;/packaging&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;name&gt;arquillian-tutorial&lt;/name&gt;&#x000A;    &lt;url&gt;http://arquillian.org&lt;/url&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;properties&gt;&#x000A;        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;&#x000A;    &lt;/properties&gt;</code>&#x000A;&#x000A;<code class="prettify">    &lt;build&gt;&#x000A;        &lt;plugins&gt;&#x000A;            &lt;plugin&gt;&#x000A;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#x000A;                &lt;version&gt;2.3.2&lt;/version&gt;&#x000A;                &lt;configuration&gt;&#x000A;                    &lt;source&gt;1.6&lt;/source&gt;&#x000A;                    &lt;target&gt;1.6&lt;/target&gt;&#x000A;                &lt;/configuration&gt;&#x000A;            &lt;/plugin&gt;&#x000A;        &lt;/plugins&gt;&#x000A;    &lt;/build&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;junit&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;junit&lt;/artifactId&gt;&#x000A;            &lt;version&gt;4.8.1&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/project&gt;</code></pre>
<p>Nous serons amenés à écrire des composants Java EE 6. Donc, nous aurons sûrement besoin d&#8217;ajouter l&#8217;API Java EE 6 dans le classpath pour pouvoir compiler ces composants.</p>
<p>Ouvrez à nouveau le fichier <code>pom.xml</code> et ajoutez le fragment XML ci dessous directement sous le tag <code>&lt;dependencies&gt;</code>.</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependencies&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;        &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;        &lt;type&gt;pom&lt;/type&gt;&#x000A;        &lt;scope&gt;provided&lt;/scope&gt;&#x000A;    &lt;/dependency&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;junit&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;junit&lt;/artifactId&gt;&#x000A;        &lt;version&gt;4.8.1&lt;/version&gt;&#x000A;        &lt;scope&gt;test&lt;/scope&gt;&#x000A;    &lt;/dependency&gt;&#x000A;&lt;/dependencies&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p class="important"><span>Nous vous recommandons vivement de <strong>ne pas utiliser</strong> <code>javax:javaee-api</code> comme artefact pour les API Java EE 6. Cet artefact contient des classes comportant des méthodes dont le code a été retiré, ce qui provoque des erreurs étranges liées à l&#8217;absence du code au runtime (même si vous n&#8217;exécutez que des tests). <a href="http://community.jboss.org/wiki/WhatsTheCauseOfThisExceptionJavalangClassFormatErrorAbsentCode">Pour plus d&#8217;information reportez vous à cette FAQ</a>.</span></p>
<p>Le squelette de votre projet est maintenant prêt ! Allez directement à la section <a href="#open_project_in_eclipse">ouvrir le projet dans eclipse</a> pour écrire un peu du code !</p>
<h4 id="create_project_using_forge">Créer un projet en utilisant Forge</h4>
<p><a href="http://jboss.org/forge">JBoss Forge</a> est un shell fournissant une ligne de commande dédiée au développement rapide d&#8217;applications respectant les standards. On peut aussi le voir comme un générateur Maven sous stéroïdes.</p>
<p>Le processus d&#8217;installation de Forge est très simple. Le guide ci-dessous vous permettra de démarrer rapidement. Vous n&#8217;aurez qu&#8217;à suivre les étapes suivantes:</p>
<ol>
	<li><a href="https://repository.jboss.org/nexus/service/local/artifact/maven/redirect?r=releases&amp;g=org.jboss.forge&amp;a=forge-distribution&amp;v=1.0.0.Final&amp;e=zip">Téléchargez Forge</a> et dézippez-le dans un dossier sur votre disque, la suite de ce guide référencera ce dossier par <code>$FORGE_HOME</code></li>
</ol>
<ol>
	<li>Ajoutez <code>$FORGE_HOME/bin</code> dans votre path (Windows, Linux or Mac OSX)</li>
</ol>
<p>Dans les systèmes d&#8217;exploitation basé sur UNIX, ajouter Forge dans votre path revient à éditer $HOME/.bashrc ou $HOME/.profile;</p>
<pre class="command"><code class="command">$ export FORGE_HOME=$HOME/forge/&#x000A;$ export PATH=$PATH:$FORGE_HOME/bin</code></pre>
<p class="info"><span>Dans Windows, vous aurez besoin de faire un clic droit sur &#8220;Panneau de configuration&#8221;, cliquez sur &#8220;Propriétés Système&#8221;, ouvrez l&#8217;onglet &#8220;Avancé&#8221; , puis cliquer sur &#8220;variables d&#8217;environnement&#8221; et ajouter ces deux entrées. Nous recommandons d&#8217;utiliser les variables utilisateurs pour Forge (et non pas des variables système), à moins que vous ayez mis la distribution dans un répertoire accessible par tous les utilisateurs.</span></p>
<p>Forge est maintenant installé, ouvrez une invite de commande et exécutez la commande <code>forge</code>:</p>
<pre class="command"><code class="command">$ forge&#x000A;   _____                    &#x000A;  |  ___|__  _ __ __ _  ___ &#x000A;  | |_ / _ \| `__/ _` |/ _ \  \\&#x000A;  |  _| (_) | | | (_| |  __/  //&#x000A;  |_|  \___/|_|  \__, |\___| &#x000A;                  |___/      </code>&#x000A; &#x000A;<code class="command">[no project] ~ $</code></pre>
<p>C&#8217;est tout ! Forge est à présent lancé. Il est maintenant temps de créer le projet.</p>
<p>Dans le shell Forge, exécutez les commandes suivantes pour créer un projet vide. La démarche est semblable à la création d&#8217;un projet via un Archetype Maven:</p>
<pre class="command"><code class="command">$ new-project --named arquillian-tutorial --topLevelPackage org.arquillian.example</code></pre>
<p>Cette commande génère un projet Java basé sur Maven dans un nouveau sous répertoire <code>arquillian-tutorial</code>  du répertoire courant.</p>
<p>La structure des fichiers du projet Forge se présente comme suit :</p>
<ul class="filetree">
	<li>src/
	<ul>
		<li>main/
		<ul>
			<li>java/ &#8211; Placez tous les fichiers Java ici (sous forme de packages java)</li>
			<li>resources/ &#8211; Mettez tous les fichiers de configurations ici.
			<ul>
				<li>META-INF/
				<ul>
					<li>forge.xml &#8211; un fichier vide pour la configuration du projet Forge</li>
				</ul></li>
			</ul></li>
		</ul></li>
		<li>test/
		<ul>
			<li>java/ &#8211; Placez tous les fichier de tests Java ici (sous forme de packages java)</li>
			<li>resources/ &#8211; Mettez tous les fichiers de configurations pour les tests ici. (i.e. arquillian.xml)</li>
		</ul></li>
	</ul></li>
	<li>pom.xml &#8211; le fichier pour le build Maven.</li>
</ul>
<p>Forge change également son répertoire courant pour le dossier de votre projet.</p>
<pre class="command"><code class="command">[arquillian-tutorial] arquillian-tutorial $ </code></pre>
<p>Par défaut, Forge configure votre projet pour utiliser Java 1.6, qui est la version Java minimale pour Arquillian.</p>
<p>Nous avons maintenant besoin d&#8217;ajouter les APIs Java EE en utilisant la commande <code>project add-dependency</code> comme suit:</p>
<pre class="command"><code class="command">$ project add-dependency org.jboss.spec:jboss-javaee-6.0:1.0.0.Final:pom:provided</code></pre>
<p>Vous aurez aussi besoin d&#8217;ajouter JUnit 4.8, la version minimale pour utiliser Arquillian. Cette dépendance doit, bien entendu, être en scope test.</p>
<pre class="command"><code class="command">$ project add-dependency junit:junit:4.8.1:test</code></pre>
<p>Forge a alors généré le pom.xml suivant:</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;?xml version="1.0" encoding="UTF-8"?&gt;&#x000A;&lt;project xmlns="http://maven.apache.org/POM/4.0.0"&#x000A;    xsi:schemaLocation="&#x000A;        http://maven.apache.org/POM/4.0.0&#x000A;        http://maven.apache.org/xsd/maven-4.0.0.xsd"&#x000A;    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&#x000A;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#x000A;    &lt;groupId&gt;org.arquillian.example&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;arquillian-tutorial&lt;/artifactId&gt;&#x000A;    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;            &lt;type&gt;provided&lt;/type&gt;&#x000A;            &lt;scope&gt;pom&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;junit&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;junit&lt;/artifactId&gt;&#x000A;            &lt;version&gt;4.8.1&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;    &lt;repositories&gt;&#x000A;      &lt;repository&gt;&#x000A;          &lt;id&gt;JBOSS_NEXUS&lt;/id&gt;&#x000A;          &lt;url&gt;http://repository.jboss.org/nexus/content/groups/public&lt;/url&gt;&#x000A;      &lt;/repository&gt;&#x000A;    &lt;/repositories&gt;&#x000A;    &lt;build&gt;&#x000A;        &lt;finalName&gt;arquillian-tutorial&lt;/finalName&gt;&#x000A;        &lt;plugins&gt;&#x000A;            &lt;plugin&gt;&#x000A;                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#x000A;                &lt;version&gt;2.3.2&lt;/version&gt;&#x000A;                &lt;configuration&gt;&#x000A;                    &lt;source&gt;1.6&lt;/source&gt;&#x000A;                    &lt;target&gt;1.6&lt;/target&gt;&#x000A;                &lt;/configuration&gt;&#x000A;            &lt;/plugin&gt;&#x000A;        &lt;/plugins&gt;&#x000A;    &lt;/build&gt;&#x000A;&lt;/project&gt;</code></pre>
<p class="info"><span>Notez qu&#8217;Arquillian est désormais disponible dans le repository Maven Central. La référence au repository JBoss pourrait donc être supprimée. Toutefois, il est probable que vous en ayez besoin pour d&#8217;autres dépendance JBoss pas encore disponibles dans le repository Maven central.</span></p>
<p class="warning"><span>Si vous considérez que la déclaration des repositories Maven dans le pom.xml est un antipattern, nous vous recommandons de lire <a href="http://community.jboss.org/wiki/MavenGettingStarted-Users">ces instructions</a> pour activer la gestion globale des repositories dans le fichier settings.xml.</span></p>
<p>La structure de votre projet est maintenant prête, il est temps de coder un peu !</p>
<h3 id="ouvrez_le_projet_dans_eclipse">Ouvrez le projet dans Eclipse</h3>
<p>Développer des projets Java nécessite d&#8217;utiliser un IDE comme Eclipse par exemple. Pour faciliter vos développements, Arquillian s&#8217;intègre facilement avec votre IDE en vous permettant de lancer vos tests Arquillian à partir de votre environnement de travail.</p>
<p>Commencez par lancer votre Eclipse. Comme le projet est utilise Maven vous aurez besoin que le plugin <a href="http://eclipse.org/m2e">Maven Integration for Eclipse</a> (m2e) soit installé dans Eclipse. Si vous n&#8217;avez encore installé ce plugin les étapes suivantes vous permettront de le faire :</p>
<ol>
	<li>Sélectionnez <code>Help &gt; Eclipse Marketplace...</code> dans la barre de menu</li>
	<li>Saisissez &#8220;jboss tools&#8221; (sans guillemets) et validez avec Entrer</li>
	<li>Cliquez sur le bouton d&#8217;installation à coté de JBoss Tools (Indigo)</li>
	<li>Terminez l&#8217;installation et redémarrez Eclipse si le logiciel vous le propose</li>
</ol>
<p>JBoss Tools fournit un environnement intégré pour les applications Java EE , Avec un excellent support de CDI&#8230;</p>
<p>Si vous voulez juste l&#8217;intégration pour Maven sans les autres outils, vous pouvez suivre ces étapes:</p>
<ol>
	<li>Sélectionnez <code>Help &gt; Eclipse Marketplace...</code> dans la barre de menu</li>
	<li>Saisissez &#8220;maven&#8221; (sans guillemets) et validez avec Entrer</li>
	<li>Cliquer sur le bouton d&#8217;installation</li>
	<li>Terminez l&#8217;installation et redémarrez Eclipse si le logiciel vous le propose</li>
	<li>Répétez les mêmes étapes pour installer l&#8217;intégration Maven pour Eclipse WTP</li>
</ol>
<p>Une fois le plugin Maven installé, suivez ces étapes pour ouvrir votre projet:</p>
<ol>
	<li>Sélectionnez <code>File &gt; Import...</code> dans la barre de menu</li>
	<li>Saisissez &#8220;existing maven&#8221; dans le champ de recherche</li>
	<li>Choisissez l&#8217;option &#8220;Existing Maven Projects&#8221;, puis cliquez sur le bouton &#8220;Next&#8221;.</li>
	<li>Cliquez sur le bouton &#8220;Browse&#8230;&#8221;</li>
	<li>Naviguez vers votre projet et cliquez sur le bouton &#8220;Ok&#8221;.</li>
	<li>Cliquez sur le bouton &#8220;Finish&#8221; pour ouvrir le projet.</li>
</ol>
<p>Eclipse va reconnaitre et ouvrir votre projet Maven dans la vue navigateur. Si vous dépliez le projet, vous devez normalement obtenir quelque chose de semblable à ça :</p>
<p><img src="/images/guides/arquillian_tutorial_eclipse_project.png" alt="" /></p>
<p>Nous pouvons maintenant entrer dans le vif du sujet !</p>
<h3 id="cr&#233;er_un_composant">Créer un composant</h3>
<p>Pour écrire un test Arquillian, nous avons besoin d&#8217;un composant à tester. Commençons par un composant basique pour créer un test Arquillian simple. Nous passerons ensuite à des scénarios de test plus complexes.</p>
<p>Dans votre IDE, créez une nouvelle classe Java <code>Greeter</code> dans le package <code>org.arquillian.example</code>. Remplacez le contenu du fichier avec ce code :</p>
<div class="filename">src/main/java/org/arquillian/example/Greeter.java</div>
<pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import java.io.PrintStream;</code>&#x000A;&#x000A;<code class="prettify">/**&#x000A; * A component for creating personal greetings.&#x000A; */&#x000A;public class Greeter {&#x000A;    public void greet(PrintStream to, String name) {&#x000A;        to.println(createGreeting(name));&#x000A;    }</code>&#x000A;&#x000A;<code class="prettify">    public String createGreeting(String name) {&#x000A;        return "Hello, " + name + "!";&#x000A;    }&#x000A;}</code></pre>
<p>Nous souhaitons vérifier que cette classe se comporte correctement lorsqu&#8217;elle est invoquée en tant que bean CDI (Contexts and Dependency Injection). Evidement nous pourrions écrire un simple test unitaire, mais supposons que cette classe fasse appel à des services d&#8217;entreprise comme l&#8217;injection de dépendance et le messaging et doive donc être utilisée dans un conteneur (ou que nous anticipions son futur enrichissement <img src="/images/emoticons/wink.png" alt=";)" class="emoticon" /></p>
<p>Pour utiliser cette classe en tant que bean CDI, nous devons l&#8217;injecter dans le test via l&#8217;annotation <code>@Inject</code>. Cela nécessite que notre test utilise Arquillian ! Il est donc temps d&#8217;ajouter les APIs Arquillian à notre projet !</p>
<h3 id="ajoutez_les_apis_arquillian">Ajoutez les APIs Arquillian</h3>
<p>A nouveau, éditez le fichier <code>pom.xml</code> situé dans la racine du projet. Nous devons indiquer à Maven les versions des artefacts à utiliser. Insérez l&#8217;extrait suivant juste au dessus de la section <code>&lt;build&gt;</code> pour importer le BOM (Bill of Materials) d&#8217;Arquillian (une compilation des atefacts et dépendances transitives nécessaires à la configuration du framework)</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependencyManagement&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.3.Final&lt;/version&gt;&#x000A;            &lt;scope&gt;import&lt;/scope&gt;&#x000A;            &lt;type&gt;pom&lt;/type&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/dependencyManagement&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p>Puis ajoutez l&#8217;extrait XML suivant juste sous le dernier élément <code>&lt;dependency&gt;</code> pour ajouter l&#8217;intégration Arquillian à JUnit :</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependency&gt;&#x000A;    &lt;groupId&gt;org.jboss.arquillian.junit&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;arquillian-junit-container&lt;/artifactId&gt;&#x000A;    &lt;scope&gt;test&lt;/scope&gt;&#x000A;&lt;/dependency&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p>L&#8217;artefact d&#8217;intégration Arquillian à JUnit ajoute également par transitivité les APIs Arquillian et ShrinkWrap au classpath de test. Toutes ces bibliothèques sont nécessaires pour écrire et compiler un test Arquillian sous JUnit.</p>
<p class="info"><span>Pour utiliser TestNG à la place de JUnit, il suffit de remplacer l&#8217;artefact d&#8217;intégration JUnit Arquillian avec celui d&#8217;intégration TestNG Arquillian</span></p>
<p>Si vous rencontrez des problèmes avec votre pom.xml à ce stade, vous pouvez télécharger le fichier via <a href="https://gist.github.com/1263892">ce gist</a>.</p>
<p><strong>Vous êtes prêt à écrire votre premier test Arquillian !</strong></p>
<h3 id="ecrivez_un_test_arquillian">Ecrivez un Test Arquillian</h3>
<p>Un test Arquillian ressemble à un test unitaire classique avec quelques petits ajustements. Retournons à l&#8217;IDE</p>
<p class="warning"><span>Si l&#8217;IDE vous affiche le message &#8220;Project configuration is out of date with pom.xml&#8221; faites un clic droit sur le projet et sélectionnez Maven &gt; Update Project Configuration pour re-synchroniser le projet</span></p>
<p>Commencez par créer un nouveau test JUnit dans src/test/java au sein du package <code>org.arquillian.example</code> et appelez-le <code>GreeterTest</code>. Vous n&#8217;aurez pas besoin d&#8217;effectuer une configuration compliquée car Arquillian s&#8217;occupe de cette partie ingrate. Voici ce que nous devons déjà avoir :</p>
<div class="filename">src/test/java/org/arquillian/example/GreeterTest.java</div>
<pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import org.junit.Assert;&#x000A;import org.junit.Test;</code>&#x000A;&#x000A;<code class="prettify">public class GreeterTest {&#x000A;    @Test&#x000A;    public void should_create_greeting() {&#x000A;        Assert.fail("Not yet implemented");&#x000A;    }&#x000A;}</code></pre>
<p>Venons-en aux fameux ajustements. Un cas de test Arquillian doit contenir trois éléments :</p>
<ol>
	<li>une annotation <code>@RunWith(Arquillian.class)</code> sur la classe</li>
	<li>Une méthode statique retournant une archive ShrinkWrap annotée avec <code>@Deployment</code></li>
	<li>Au mois une méthode annotée avec <code>@Test</code></li>
</ol>
<p>L&#8217;annotation <code>@RunWith</code> indique à JUnit d&#8217;utiliser Arquillian comme contrôleur pour le test. Arquillian cherche alors une méthode statique annotée avec <code>@Deployment</code> pour récupérer l&#8217;archive de test (i.e. le micro-déploiement). C&#8217;est là que l&#8217;effet magique se produit en faisant en sorte que toutes les méthodes @@Test soient exécutées dans l&#8217;environnement du conteneur.</p>
<h4>Qu&#8217;est-ce qu&#8217;une archive de test ?</h4>
<p>L&#8217;objectif de l&#8217;archive de test est d&#8217;isoler les classes et ressources nécessaires au test en écartant le reste. Contrairement à un test unitaire classique, le test Arquillian ne va pas rechercher dans tout le classpath. Vous incluez seulement ce dont le test à besoin (éventuellement tout le classpath si c&#8217;est nécessaire). L&#8217;archive en question est définie à l&#8217;aide de <a href="http://jboss.org/shrinkwrap">ShrinkWrap</a>, une API java pour générer des archives (i.e. jar, war, ear). L&#8217;approche par micro-déploiement permet de vous concentrer sur les classes que vous souhaitez tester et sur elles-seules.</p>
<p class="info"><span>ShrinkWrap permet également la récupération d&#8217;artefacts et la création de fichier de configuration qui peuvent être ajoutés à l&#8217;archive de test. Pour une introduction plus complète à ShrinkWrap, référez vous à <a href="/guides/shrinkwrap_introduction">ShrinkWrap introduction</a> guide.</span></p>
<p>Ajoutons le déploiement à notre test :</p>
<div class="filename">src/test/java/org/arquillian/example/GreeterTest.java</div>
<pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import org.jboss.arquillian.container.test.api.Deployment;&#x000A;import org.jboss.arquillian.junit.Arquillian;&#x000A;import org.jboss.shrinkwrap.api.ShrinkWrap;&#x000A;import org.jboss.shrinkwrap.api.asset.EmptyAsset;&#x000A;import org.jboss.shrinkwrap.api.spec.JavaArchive;&#x000A;import org.junit.Assert;&#x000A;import org.junit.Test;&#x000A;import org.junit.runner.RunWith;</code>&#x000A;&#x000A;<code class="prettify">@RunWith(Arquillian.class)&#x000A;public class GreeterTest {</code>&#x000A;&#x000A;<code class="prettify">    @Deployment&#x000A;    public static JavaArchive createDeployment() {&#x000A;        return ShrinkWrap.create(JavaArchive.class)&#x000A;            .addClass(Greeter.class)&#x000A;            .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");&#x000A;    }</code>&#x000A;&#x000A;<code class="prettify">    @Test&#x000A;    public void should_create_greeting() {&#x000A;        Assert.fail("Not yet implemented");&#x000A;    }&#x000A;}</code></pre>
<p>Avec ShrinkWrap nous avons défini une archive Java (jar) pour le déploiement. Cette dernière inclut la classe <code>Greeter</code> que le test invoquera et un fichier beans.xml vide dans le répertoire META-INF pour activer CDI dans l&#8217;archive.</p>
<p>A présent, tout ce que nous devons faire c&#8217;est injecter une instance de <code>Greeter</code> dans un champ juste au dessus de la méthode de test et de remplacer la méthode de test non implémentée par du code vérifiant le comportement du bean. Pour parfaire cette (future) sensation de plénitude, nous imprimerons le message de bienvenue dans la console.</p>
<div class="filename">src/test/java/org/arquillian/example/GreeterTest.java</div>
<pre class="prettify"><code class="prettify">// clip&#x000A;import javax.inject.Inject;&#x000A;// clip</code>&#x000A;&#x000A;<code class="prettify">@Inject&#x000A;Greeter greeter;</code>&#x000A;&#x000A;<code class="prettify">@Test&#x000A;public void should_create_greeting() {&#x000A;    Assert.assertEquals("Hello, Earthling!",&#x000A;        greeter.createGreeting("Earthling"));&#x000A;    greeter.greet(System.out, "Earthling");&#x000A;}</code></pre>
<p>Voici la tête du test quand vous aurez fini :</p>
<div class="filename">src/test/java/org/arquillian/example/GreeterTest.java</div>
<pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import javax.inject.Inject;&#x000A;import org.jboss.arquillian.container.test.api.Deployment;&#x000A;import org.jboss.arquillian.junit.Arquillian;&#x000A;import org.jboss.shrinkwrap.api.ShrinkWrap;&#x000A;import org.jboss.shrinkwrap.api.asset.EmptyAsset;&#x000A;import org.jboss.shrinkwrap.api.spec.JavaArchive;&#x000A;import org.junit.Test;&#x000A;import org.junit.Assert;&#x000A;import org.junit.runner.RunWith;</code>&#x000A;&#x000A;<code class="prettify">@RunWith(Arquillian.class)&#x000A;public class GreeterTest {</code>&#x000A;&#x000A;<code class="prettify">    @Deployment&#x000A;    public static JavaArchive createDeployment() {&#x000A;        return ShrinkWrap.create(JavaArchive.class)&#x000A;            .addClass(Greeter.class)&#x000A;            .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");&#x000A;    }</code>&#x000A;&#x000A;<code class="prettify">    @Inject&#x000A;    Greeter greeter;</code>&#x000A;&#x000A;<code class="prettify">    @Test&#x000A;    public void should_create_greeting() {&#x000A;        Assert.assertEquals("Hello, Earthling!",&#x000A;            greeter.createGreeting("Earthling"));&#x000A;        greeter.greet(System.out, "Earthling");&#x000A;    }&#x000A;}</code></pre>
<p>Vous venez d&#8217;écrire votre premier test Arquillian !</p>
<p>Bien, mais vous vous demandez peut être comment l&#8217;exécuter <img src="/images/emoticons/confused.png" alt=":S" class="emoticon" /> Si vous vous dites &#8220;Comme un test unitaire&#8221; vous avez bon ! Toutefois, nous devons auparavant ajouter un adaptateur de conteneur au classpath.</p>
<h3 id="ajout_d_un_adaptateur_de_conteneur">Ajout d&#8217;un adaptateur de conteneur</h3>
<p>Nous avons beaucoup parlé d&#8217;exécuter des tests dans un conteneur, mais jusqu&#8217;ici nous n&#8217;avons pas mentionné lequel. C&#8217;est parce qu&#8217;il s&#8217;agit d&#8217;une décision à prendre au runtime.</p>
<p>Arquillian choisit le conteneur cible en fonction de l&#8217;adaptateur de conteneur disponible dans le classpath de test. Cela implique l&#8217;ajout de nouvelles bibliothèques au projet.</p>
<p>Un test Arquillian peut être exécuté dans n&#8217;importe quel conteneur supportant le modèle de programmation utilisé dans le test (à partir du moment où le conteneur dispose d&#8217;un adaptateur Arquillian). Notre test utilise le modèle de programmation CDI, nous devons donc utiliser un conteneur supportant CDI. Pour être le plus efficace dans nos développement nous utiliserons le conteneur embarqué Weld EE (Weld EE embedded container).</p>
<p>Ouvrez une nouvelle fois le fichier <code>pom.xml</code> et ajoutez le groupe de dépendances suivant juste au dessous des autres éléments <code>&lt;dependency&gt;</code> :<br />
div(filename). pom.xml</p>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependency&gt;&#x000A;    &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;arquillian-weld-ee-embedded-1.1&lt;/artifactId&gt;&#x000A;    &lt;version&gt;1.0.0.CR3&lt;/version&gt;&#x000A;    &lt;scope&gt;test&lt;/scope&gt;&#x000A;&lt;/dependency&gt;&#x000A;&lt;dependency&gt;&#x000A;    &lt;groupId&gt;org.jboss.weld&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;weld-core&lt;/artifactId&gt;&#x000A;    &lt;version&gt;1.1.5.Final&lt;/version&gt;&#x000A;    &lt;scope&gt;test&lt;/scope&gt;&#x000A;&lt;/dependency&gt;&#x000A;&lt;dependency&gt;&#x000A;    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;&#x000A;    &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;&#x000A;    &lt;version&gt;1.6.4&lt;/version&gt;&#x000A;    &lt;scope&gt;test&lt;/scope&gt;&#x000A;&lt;/dependency&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p>En résumé, les trois bibliothèques dont vous aurez besoin pour utiliser Arquillian (avec JUnit) sont :</p>
<ol>
	<li>L&#8217;intégration Arquillian pour JUnit</li>
	<li>L&#8217;adaptateur Arquillian pour le conteneur cible</li>
	<li>Le runtime du conteneur (pour un conteneur embarqué) ou le conteneur lieur même (pour un conteneur à distance)</li>
</ol>
<p>Dans notre exemple, nous utilisons le conteneur Weld embarqué.</p>
<p>Retournons maintenant à notre test.</p>
<h3 id="ex&#233;cutez_le_test_arquillian">Exécutez le Test Arquillian</h3>
<p>Une fois que vous avez ajouté toutes les bibliothèques nécessaires au classpath, vous pouvez exécuter le test Arquillian comme un test unitaire, depuis votre IDE, le script de build ou tout autre plugin de test. Regardons ce que ça donne dans Eclipse.</p>
<p>Dans la fenêtre de l&#8217;IDE, cliquez droit sur fichier GreeterTest.java à partir du package explorer (ou l&#8217;éditeur) et choisissez Run as &gt; JUnit Test dans le menu contextuel.</p>
<p><img src="/images/guides/arquillian_tutorial_run_junit_test.png" alt="" /></p>
<p>Lorsque vous lancez le test, vous devez voir les lignes suivantes s&#8217;afficher dans la console :</p>
<pre class="output"><code class="output">21 [main] INFO org.jboss.weld.Version - WELD-000900 1.1.5 (Final)&#x000A;Hello, Earthling!</code></pre>
<p>Vous devez également voir apparaître la vue JUnit, révélant une <strong class="greenbar">barre verte</strong> !</p>
<p><img src="/images/guides/arquillian_tutorial_junit_green_bar.png" alt="" /></p>
<p>Vous pouvez également lancer le test depuis la ligne de commande via Maven :</p>
<pre class="command"><code class="command">$ mvn test</code></pre>
<p>Vous devez voir les lignes suivantes s&#8217;afficher dans la console :</p>
<pre class="output"><code class="output">-------------------------------------------------------&#x000A;T E S T S&#x000A;-------------------------------------------------------&#x000A;Running org.arquillian.example.GreeterTest&#x000A;19 [main] INFO org.jboss.weld.Version - WELD-000900 1.1.5 (Final)&#x000A;Hello, Earthling!&#x000A;Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.907 sec</code></pre>
<p><strong>Félicitations !</strong> vous venez de remporter votre première <strong class="greenbar">barre verte</strong> avec Arquillian !</p>
<h3 id="regardons_de_plus_pr&#234;t">Regardons de plus prêt</h3>
<p>Comme savoir si CDI a vraiment fonctionné ? Tout ce que nous pouvons dire, c&#8217;est qu&#8217;Arquillian a créé une nouvelle instance de la classe <code>Greeter</code> et l&#8217;a injectée dans le test sans savoir si CDI a été sollicité. Pour prouver que CDI est là lançons une petite démonstration.</p>
<p>Créez un nouveau bean CDI appelé <code>PhraseBuilder</code> dans le package <code>org.arquillian.example</code>. Ce bean peut fournir des phrases à partir de modèles.</p>
<div class="filename">src/main/java/org/arquillian/example/PhraseBuilder.java</div>
<pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import java.text.MessageFormat;&#x000A;import java.util.HashMap;&#x000A;import java.util.Map;&#x000A;import javax.annotation.PostConstruct;</code>&#x000A;&#x000A;<code class="prettify">public class PhraseBuilder {&#x000A;    private Map&lt;String, String&gt; templates;</code>&#x000A;&#x000A;<code class="prettify">    public String buildPhrase(String id, Object... args) {&#x000A;        return MessageFormat.format(templates.get(id), args);&#x000A;    }</code>&#x000A;&#x000A;<code class="prettify">    @PostConstruct&#x000A;    public void initialize() {&#x000A;        templates = new HashMap&lt;String, String&gt;();&#x000A;        templates.put("hello", "Hello, {0}!");&#x000A;    }&#x000A;}</code></pre>
<p>Ensuite, éditez la classe <code>Greeter</code> et ajoutez-y un nouveau constructeur qui injectera <code>PhraseBuilder</code> via le mécanisme d&#8217;injection dans le constructeur de CDI. Déléguez, ensuite la tâche de création du message de bienvenue au bean injecté.</p>
<div class="filename">src/main/java/org/arquillian/example/Greeter.java</div>
<pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import java.io.PrintStream;&#x000A;import javax.inject.Inject;</code>&#x000A;&#x000A;<code class="prettify">public class Greeter {</code>&#x000A;&#x000A;<code class="prettify">    private PhraseBuilder phraseBuilder;</code>&#x000A;&#x000A;<code class="prettify">    @Inject&#x000A;    public Greeter(PhraseBuilder phraseBuilder) {&#x000A;        this.phraseBuilder = phraseBuilder;&#x000A;    }</code>&#x000A;&#x000A;<code class="prettify">    public void greet(PrintStream to, String name) {&#x000A;        to.println(createGreeting(name));&#x000A;    }</code>&#x000A;&#x000A;<code class="prettify">    public String createGreeting(String name) {&#x000A;        return phraseBuilder.buildPhrase("hello", name);&#x000A;    }&#x000A;}</code></pre>
<p>Maintenant, pour que le test fonctionne, une instance de <code>PhraseBuilder</code> doit être créée, sa méthode de callback <code>@postConstruct</code> invoquée et doit être injectée dans le constructeur de <code>Greeter</code> lorsqu&#8217;une instance de <code>Greeter</code> est créée. Si tout ça fonctionne, c&#8217;est forcément que CDI est à l&#8217;oeuvre.</p>
<p>Dernière point. Comme nous créons une nouvelle classe, nous devons être sûrs qu&#8217;elle sera ajoutée dans l&#8217;archive retournée par la méthode <code>@Deployment</code> du test. Il suffit juste de changer la ligne :</p>
<pre class="prettify"><code class="prettify">.addClass(Greeter.class)</code></pre>
<p>&#8230; en:</p>
<pre class="prettify"><code class="prettify">.addClasses(Greeter.class, PhraseBuilder.class)</code></pre>
<p>Lancez le test à nouveau. Vous devez obtenir une autre <strong class="greenbar">barre verte</strong> ! Ca le fait, hein ?</p>
<h3 id="d&#233;boguez_le_test">Déboguez le Test</h3>
<p>Ce chapitre sera court. Pourquoi ? Parce qu&#8217;un test Arquillian se debogue exactement comme un test unitaire. Ajoutez juste un point d&#8217;arrêt soit dans le test soit dans le code testé. Ensuite, faites un cic droit sur le fichier et choisissez Debug As &gt; JUnit Test. Vous allez pouvoir déboguer dans le conteneur ! Amusez-vous à explorer le contexte de votre code !</p>
<p><img src="/images/guides/arquillian_tutorial_debugging_test.png" alt="" /></p>
<p class="warning"><span>Si vous utilisez un conteneur en mode remote, &#8220;Debug As&#8221; n&#8217;active pas les points d&#8217;arrêt. Vous aurez besoin de démarrer le conteneur en mode debug et d&#8217;y associer le débogueur. Ceci est dû au fait que le test tourne dans une JVM différente du moteur qui l&#8217;a déclenché</span></p>
<p>Comme nous venons de le démontrer Arquillian est l&#8217;outil idéal pour tester des applications CDI. Il s&#8217;occupe de charger l&#8217;environnement CDI et d&#8217;injecter les beans directement dans le test. Encore mieux en utilisant un conteneur CDI embarqué, le test s&#8217;exécute aussi rapidement qu&#8217;un test unitaire. Si vous n&#8217;avez besoin de rien de plus, vous pouvez arrêter ce tutoriel et commencer à écrire vos tests.</p>
<p><strong>Mais !</strong> Le conteneur embarqué est-il suffisant ? Notre composant fonctionnera-t&#8217;il s&#8217;il est exécuté dans un vrai conteneur ?</p>
<p>L&#8217;un des atouts d&#8217;Arquillian est qu&#8217;il permet de lancer le même test dans des conteneurs différents, qu&#8217;il s&#8217;agisse d&#8217;un autre conteneur embarqué ou d&#8217;un conteneur effectif. Si vous envisagez d&#8217;utiliser plusieurs conteneurs poursuivez votre lecture.</p>
<h3 id="ajoutez_d_autres_conteneurs">Ajoutez d&#8217;autres Conteneurs</h3>
<p>Comme vous l&#8217;avez vu précédemment, Arquillian choisit le conteneur en fonction de l&#8217;adaptateur de conteneur présent dans le classpath. Pour changer de conteneur, il suffit donc de changer l&#8217;adaptateur disponible dans le classpath avant le lancement du test.</p>
<p class="important"><span>Il ne peut y avoir qu&#8217;un seul adaptateur présent dans le classpath.</span></p>
<p>Une façon de changer les bibliothèques présentes dans le classpath est d&#8217;éditer manuellement les dépendances définies dans le <code>pom.xml</code>  chaque fois que nécessaire. Mais ça devient vite n&#8217;importe quoi. Il y a une solution nettement meilleure.</p>
<p>Nous pouvons utiliser des profils Maven pour séparer les dépendances dans différents groupes pour chaque adaptateur de conteneur et leurs dépendances associées. Lorsque vous lancez les tests vous activez l&#8217;un de ces groupes pour choisir le conteneur, soit en paramètre en ligne de commande (-P) ou une préférence dans l&#8217;IDE.</p>
<p>Ouvrez le fichier <code>pom.xml</code> et ajoutez un nouveau profil pour le conteneur Weld EE embarqué en insérant l&#8217;extrait XML suivant juste sous l&#8217;élément <code>&lt;dependencies&gt;</code> :</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;profiles&gt;&#x000A;    &lt;profile&gt;&#x000A;        &lt;id&gt;arquillian-weld-ee-embedded&lt;/id&gt;&#x000A;        &lt;dependencies&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;                &lt;type&gt;pom&lt;/type&gt;&#x000A;                &lt;scope&gt;provided&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;arquillian-weld-ee-embedded-1.1&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.0.0.CR3&lt;/version&gt;&#x000A;                &lt;scope&gt;test&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.jboss.weld&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;weld-core&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.1.5.Final&lt;/version&gt;&#x000A;                &lt;scope&gt;test&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.6.4&lt;/version&gt;&#x000A;                &lt;scope&gt;test&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;        &lt;/dependencies&gt;&#x000A;    &lt;/profile&gt;&#x000A;&lt;/profiles&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p>Ensuite <strong>retirez</strong> les dépendances <code>jboss-javaee-6.0</code> et celles pour l&#8217;adaptateur Weld EE embarqué de la section <code>&lt;dependencies&gt;</code> principale. Voici à quoi les sections  <code>&lt;dependencies&gt;</code> et <code>&lt;profiles&gt;</code> doivent ressembler lorsque vous avez fini :</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;dependencies&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;junit&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;junit&lt;/artifactId&gt;&#x000A;        &lt;version&gt;4.8.1&lt;/version&gt;&#x000A;        &lt;scope&gt;test&lt;/scope&gt;&#x000A;    &lt;/dependency&gt;&#x000A;    &lt;dependency&gt;&#x000A;        &lt;groupId&gt;org.jboss.arquillian.junit&lt;/groupId&gt;&#x000A;        &lt;artifactId&gt;arquillian-junit-container&lt;/artifactId&gt;&#x000A;        &lt;scope&gt;test&lt;/scope&gt;&#x000A;    &lt;/dependency&gt;&#x000A;&lt;/dependencies&gt;&#x000A;&lt;profiles&gt;&#x000A;    &lt;profile&gt;&#x000A;        &lt;id&gt;arquillian-weld-ee-embedded&lt;/id&gt;&#x000A;        &lt;dependencies&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;                &lt;type&gt;pom&lt;/type&gt;&#x000A;                &lt;scope&gt;provided&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;arquillian-weld-ee-embedded-1.1&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.0.0.CR3&lt;/version&gt;&#x000A;                &lt;scope&gt;test&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.jboss.weld&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;weld-core&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.1.5.Final&lt;/version&gt;&#x000A;                &lt;scope&gt;test&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;            &lt;dependency&gt;&#x000A;                &lt;groupId&gt;org.slf4j&lt;/groupId&gt;&#x000A;                &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;&#x000A;                &lt;version&gt;1.6.4&lt;/version&gt;&#x000A;                &lt;scope&gt;test&lt;/scope&gt;&#x000A;            &lt;/dependency&gt;&#x000A;        &lt;/dependencies&gt;&#x000A;    &lt;/profile&gt;&#x000A;&lt;/profiles&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p class="info"><span>La dépendance Java EE API a été déplacée dans le profil car certains conteneurs, comme Glassfish embarqué, fournissent déjà ces bibliothèques. Avoir les deux dans le classpath en même temps créerait des conflits. Raison pour laquelle nous devons faire cette gymnastique des classpath</span></p>
<p>Nous allons maintenant ajouter deux nouveaux profils dans le <code>pom.xml</code> au sein de l&#8217;élément <code>&lt;profiles&gt;</code>. Le premier pour <a href="http://embedded-glassfish.java.net">Glassfish embarqué</a> :</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;profile&gt;&#x000A;    &lt;id&gt;arquillian-glassfish-embedded&lt;/id&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;arquillian-glassfish-embedded-3.1&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.0.CR2&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.glassfish.main.extras&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;glassfish-embedded-all&lt;/artifactId&gt;&#x000A;            &lt;version&gt;3.1.2&lt;/version&gt;&#x000A;            &lt;scope&gt;provided&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/profile&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p>et le second pour JBoss AS managé :</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;profile&gt;&#x000A;    &lt;id&gt;arquillian-jbossas-managed&lt;/id&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;            &lt;type&gt;pom&lt;/type&gt;&#x000A;            &lt;scope&gt;provided&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.as&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;jboss-as-arquillian-container-managed&lt;/artifactId&gt;&#x000A;            &lt;version&gt;7.1.1.Final&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/profile&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
<p>Vous pouvez maintenant choisir de lancer vos tests dans l&#8217;un des 3 conteneurs.</p>
<p>Si vous rencontrez des problèmes avec votre pom.xml à ce stade, vous pouvez télécharger le fichier via <a href="https://gist.github.com/1263934">ce gist</a>.</p>
<h3 id="testez_avec_plusieurs_conteneurs">Testez avec plusieurs conteneurs</h3>
<p>Lorsque vous rafraichirez le projet dans Eclipse vous remarquerez qu&#8217;il ne se construit plus. C&#8217;est parce qu&#8217;il vous faut activer l&#8217;un des profils de conteneur. Activons le profil Weld EE embarqué pour revenir au comportement précédent.</p>
<p>Il y a deux façons d&#8217;activer un profil Maven dans Eclipse :</p>
<ol>
	<li>La configuration manuelle (approche standard)</li>
	<li>L&#8217;activateur de profil Maven (avec JBoss Tools)</li>
</ol>
<h4>Activation du profil Maven manuellement</h4>
<p>Pour activer le profil manuellement, suivez ces étapes :</p>
<ol>
	<li>Faites un clic droit sur le projet et choisissez Properties</li>
	<li>Choisissez l&#8217;onglet Maven properties</li>
	<li>Saisissez l&#8217;identifiant de profil le champ Active Maven Profiles (i.e., <code>arquillian-weld-ee-embedded</code>)</li>
	<li>Cliquez sur OK pour accepter le changement de configuration du projet</li>
</ol>
<p>Voici l&#8217;écran des propriétés Maven montrant le profil que nous venons d&#8217;activer :</p>
<p><img src="/images/guides/arquillian_tutorial_maven_properties.png" alt="" /></p>
<h4>Activation du profil Maven via l&#8217;activateur de profil</h4>
<p>Si JBoss Tools est installé, choisir le profil actif est nettement plus facile :</p>
<ol>
	<li>Faites un clic droit sur le projet et choisissez Maven &gt; Select Active Profiles&#8230;<br />
(alternativement, vous pouvez utiliser le raccourci Ctrl-Shift-P ou le bouton dans la barre d&#8217;icônes)</li>
	<li>Cochez la case correspondant au profil souhaité (i.e., <code>arquillian-weld-ee-embedded</code>)</li>
	<li>Cliquez sur OK</li>
</ol>
<p>Voici la boîte de dialogue de sélection de profil Maven montrant le profil que nous venons d&#8217;activer</p>
<p><img src="/images/guides/arquillian_tutorial_maven_profile_selector.png" alt="" /></p>
<p>Une fois le profil activé, vous devriez pouvoir lancer le test à nouveau.</p>
<p>Vous savez déjà comment le test fonctionne dans Weld EE embarqué. Changeons pour le conteneur Glassfish embarqué en répétant les étapes ci-dessus et activant seulement le profil <code>arquillian-glassfish-embedded</code>. Exécutez le test à nouveau. Vous devriez voir Glassfish démarrer dans la console&#8230; et une autre <strong class="greenbar">barre verte</strong> !</p>
<p>Vous avez donc exécuté le même test dans deux conteneurs embarqués différents. Un conteneur CDI (Weld) et un conteneur Java EE (Glassfish). Dans les deux cas le test est exécuté dans le même processus. Pour être vraiment sûr que le composant fonctionne dans un vrai environnement, nous devons utiliser un conteneur indépendant. Changeons de profil pour utiliser JBoss AS.</p>
<p>Pour lancer le test dans une instance indépendante de JBoss AS, vous devez tout d&#8217;abord la configurer. Vous pouvez soit :</p>
<ol>
	<li>Le télécharger et le décompresser dans un endroit en dehors du projet, ou</li>
	<li>vous pouvez demander à Maven de le télécharger et décompresser pour vous pendant le build</li>
</ol>
<p>Suivez ces étapes pour configurer JBoss AS 7 en dehors du projet :</p>
<ol>
	<li><a href="http://jboss.org/jbossas/downloads">Téléchargez JBoss AS 7</a><br />
(assurez-vous que la version que vous choisissez correspond à la version que vous avez définie dans votre <code>pom.xml</code> pour <code>&lt;artifactId&gt;jboss-as-arquillian-container-managed&lt;/artifactId&gt;</code>)</li>
	<li>Décompressez l&#8217;archive</li>
	<li>(optionnel) Définissez la variable d&#8217;environnement <code>JBOSS_HOME</code> en lui donnant comme valeur le chemin du répertoire de décompression</li>
</ol>
<p>Pour que Maven gère cette tache à votre place, ajoutez l&#8217;extrait XML suivant sous l&#8217;élément <code>&lt;id&gt;</code> du profil <code>arquillian-jbossas-managed</code> :</p>
<div class="filename">pom.xml</div>
<pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;build&gt;&#x000A;    &lt;plugins&gt;&#x000A;        &lt;plugin&gt;&#x000A;            &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;&#x000A;            &lt;executions&gt;&#x000A;                &lt;execution&gt;&#x000A;                    &lt;id&gt;unpack&lt;/id&gt;&#x000A;                    &lt;phase&gt;process-test-classes&lt;/phase&gt;&#x000A;                    &lt;goals&gt;&#x000A;                        &lt;goal&gt;unpack&lt;/goal&gt;&#x000A;                    &lt;/goals&gt;&#x000A;                    &lt;configuration&gt;&#x000A;                        &lt;artifactItems&gt;&#x000A;                            &lt;artifactItem&gt;&#x000A;                                &lt;groupId&gt;org.jboss.as&lt;/groupId&gt;&#x000A;                                &lt;artifactId&gt;jboss-as-dist&lt;/artifactId&gt;&#x000A;                                &lt;version&gt;7.1.1.Final&lt;/version&gt;&#x000A;                                &lt;type&gt;zip&lt;/type&gt;&#x000A;                                &lt;overWrite&gt;false&lt;/overWrite&gt;&#x000A;                                &lt;outputDirectory&gt;target&lt;/outputDirectory&gt;&#x000A;                            &lt;/artifactItem&gt;&#x000A;                        &lt;/artifactItems&gt;&#x000A;                    &lt;/configuration&gt;&#x000A;                &lt;/execution&gt;&#x000A;            &lt;/executions&gt;&#x000A;        &lt;/plugin&gt;&#x000A;    &lt;/plugins&gt;&#x000A;&lt;/build&gt; &#x000A;&lt;!-- clip --&gt;</code></pre>
<p>Pour utiliser une instance JBoss A 7 comme cible, vous avez également besoin d&#8217;un petit bout de configuration Arquillian. Créez le fichier de configuration suivant et assignez à la propriété <code>jbossHome</code> le chemin où JBoss AS 7 est installé. Si vous utilisez le plugin Maven de gestion des dépendances, l&#8217;emplacement est <code>target/jboss-as-7.1.1.Final</code>.</p>
<div class="filename">src/test/resources/arquillian.xml</div>
<pre class="prettify"><code class="prettify">&lt;arquillian xmlns="http://jboss.org/schema/arquillian"&#x000A;    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&#x000A;    xsi:schemaLocation="&#x000A;        http://jboss.org/schema/arquillian&#x000A;        http://jboss.org/schema/arquillian/arquillian_1_0.xsd"&gt;&#x000A;    &lt;container qualifier="jbossas-managed" default="true"&gt;&#x000A;        &lt;configuration&gt;&#x000A;            &lt;property name="jbossHome"&gt;target/jboss-as-7.1.1.Final&lt;/property&gt;&#x000A;        &lt;/configuration&gt;&#x000A;    &lt;/container&gt;&#x000A;&lt;/arquillian&gt;</code></pre>
<p>Changez maintenant le profil Maven actif pour <code>arquillian-jbossas-managed</code>, puis lancez à nouveau le test. Vous devriez voir JBoss AS démarrer dans la console&#8230; et encore une <strong class="greenbar">barre verte</strong>!</p>
<p class="info"><span>Les messages envoyés dans System.out ont été écrits dans les logs du serveur au lieu de la console</span></p>
<p>C&#8217;est le <em>même</em> test, cette fois lancé dans un conteneur Java EE standard (non embarqué). Arquillian package le test, le déploie dans le conteneur comme une archive Java EE, exécute le test à distance, capture le résultat pour alimenter la vue JUnit dans Eclipse (ou les résultats surefire de Maven).</p>
<p>Si vous disposez de moins de temps vous pouvez également regarder <a href="http://blog.ippon.fr/2012/01/30/ippevent-arquillian-le-film/">cette présentation (en VF) d&#8217;Arquillian faite en janvier 2012 par Alexis Hassler</a>.</p>
  <h3 id="share">Share the Knowledge</h3>
  <p>Find this guide useful?</p>
  <p class="post_to_twitter"><a href="http://twitter.com/home/?status=Just%20read%20the%20%23Arquillian%20D%C3%A9marrage%20Rapide%20guide%20and%20got%20a%20%23greenbar!%20Get%20yours.%20http://arquillian.org/guides/getting_started_fr/"><img src="/images/post_to_twitter.png" alt="" /></a></p>
  <div class="g-plusone" data-size="tall"></div>
  <p>There&#8217;s a lot more about Arquillian to cover. If you&#8217;re ready to learn more, check out the <a href="/guides">other available guides</a>.</p>
  <h4>Feedback</h4>
  <p>Find a bug in the guide? Something missing? You can fix it by <a href="http://github.com/arquillian/arquillian.github.com">forking this website</a>, making the correction and <a href="http://help.github.com/send-pull-requests">sending a pull request</a>. If you&#8217;re just plain stuck, feel free to ask a question in the <a href="http://community.jboss.org/en/arquillian?view=discussions">user discussion forum</a>.</p>
  <h4>Recent Changelog</h4>
  <ul>
    <li>
      Apr 29, 2012:
      Upgrade to jboss as 7.1.1.final
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 18, 2012:
      Remove redundant metadata (internal change)
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 13, 2012:
      Upgrade weld-ee-embedded adapter to 1.0.0.cr3
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 10, 2012:
      Add javax.inject.inject import
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 10, 2012:
      Remove windows endlines
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 10, 2012:
      Update first pom.xml listing, update download links, remove dead link and clarify java version
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 04, 2012:
      Add reference_rev prolog field for translations
      <em>by Dan Allen</em>
    </li>
    <li>
      Apr 04, 2012:
      Use description in prolog for guide summary
      <em>by Dan Allen</em>
    </li>
    <li>
      Mar 29, 2012:
      Updated the versions for weld and slf4j given in the pom files from 1.1.1.final and 1.5.10 to 1.1.5.final and 1.6.4 respectively
      <em>by paul-thomson</em>
    </li>
    <li>
      Mar 28, 2012:
      Use variable for arquillian core version
      <em>by Dan Allen</em>
    </li>
    <li>
      Mar 28, 2012:
      Fix bom version; add missing import for @inject
      <em>by Craig Schwarzwald</em>
    </li>
    <li>
      Mar 25, 2012:
      Escape stray inline xml tags
      <em>by Dan Allen</em>
    </li>
    <li>
      Mar 12, 2012:
      Update glassfish-embedded-all version and groupid
      <em>by Dan Allen</em>
    </li>
    <li>
      Feb 29, 2012:
      Remove extra whitespace
      <em>by Dan Allen</em>
    </li>
    <li>
      Feb 17, 2012:
      Use correct username for badr
      <em>by Dan Allen</em>
    </li>
  </ul>
  <p>
    <a href="https://github.com/arquillian/arquillian.github.com/commits/develop/guides/getting_started_fr.textile">See full history &raquo;</a>
  </p>
</div>
<div id="sidebar">
  <div id="toc">
    <h3 class="chapter_header">Chapters</h3>
    <ol class="chapters">
      <li>
        <a href="#hypoth&#232;ses" id="hypothèses_link">Hypothèses</a>
      </li>
      <li>
        <a href="#cr&#233;er_un_nouveau_projet" id="créer_un_nouveau_projet_link">Créer un nouveau projet</a>
      </li>
      <li>
        <a href="#ouvrez_le_projet_dans_eclipse" id="ouvrez_le_projet_dans_eclipse_link">Ouvrez le projet dans Eclipse</a>
      </li>
      <li>
        <a href="#cr&#233;er_un_composant" id="créer_un_composant_link">Créer un composant</a>
      </li>
      <li>
        <a href="#ajoutez_les_apis_arquillian" id="ajoutez_les_apis_arquillian_link">Ajoutez les APIs Arquillian</a>
      </li>
      <li>
        <a href="#ecrivez_un_test_arquillian" id="ecrivez_un_test_arquillian_link">Ecrivez un Test Arquillian</a>
      </li>
      <li>
        <a href="#ajout_d_un_adaptateur_de_conteneur" id="ajout_d_un_adaptateur_de_conteneur_link">Ajout d&#8217;un adaptateur de conteneur</a>
      </li>
      <li>
        <a href="#ex&#233;cutez_le_test_arquillian" id="exécutez_le_test_arquillian_link">Exécutez le Test Arquillian</a>
      </li>
      <li>
        <a href="#regardons_de_plus_pr&#234;t" id="regardons_de_plus_prêt_link">Regardons de plus prêt</a>
      </li>
      <li>
        <a href="#d&#233;boguez_le_test" id="déboguez_le_test_link">Déboguez le Test</a>
      </li>
      <li>
        <a href="#ajoutez_d_autres_conteneurs" id="ajoutez_d_autres_conteneurs_link">Ajoutez d&#8217;autres Conteneurs</a>
      </li>
      <li>
        <a href="#testez_avec_plusieurs_conteneurs" id="testez_avec_plusieurs_conteneurs_link">Testez avec plusieurs conteneurs</a>
      </li>
      <li>
        <a href="#share" id="share_link">Share the Knowledge</a>
      </li>
    </ol>
  </div>
</div>
<script>
  $(window).load(function() { activateScrollingToc(['hypothèses', 'créer_un_nouveau_projet', 'ouvrez_le_projet_dans_eclipse', 'créer_un_composant', 'ajoutez_les_apis_arquillian', 'ecrivez_un_test_arquillian', 'ajout_d_un_adaptateur_de_conteneur', 'exécutez_le_test_arquillian', 'regardons_de_plus_prêt', 'déboguez_le_test', 'ajoutez_d_autres_conteneurs', 'testez_avec_plusieurs_conteneurs', 'share']) })
</script>
  </div>
</div>
    <footer>
      <div class="container">
        <div class="project">
          <img src="/images/arquillian_logo_200px.png" />
          <p class="bottom">
            &#169;
            Copyright 2009-2012 Red Hat, Inc.
            <br />
            <i class="icon-fire"></i>
            Mixed with <a href="http://twitter.github.com/bootstrap">Bootstrap</a>. Baked by <a href="http://awestruct.org">Awestruct</a>.
            <br />
            <i class="icon-share-alt"></i>
            Website and docs licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.
            <br />
            Code released under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, v2.0</a>.
          </p>
        </div>
        <div class="footer-nav">
          <h4>Learn</h4>
          <ul>
            <li>
              <a href="/invasion">Mission</a>
            </li>
            <li>
              <a href="/features">Features</a>
            </li>
            <li>
              <a href="/guides">Guides</a>
            </li>
            <li>
              <a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Manual</a>
            </li>
            <li>
              <a href="http://community.jboss.org/en/arquillian/faq">FAQs</a>
            </li>
          </ul>
        </div>
        <div class="footer-nav">
          <h4>Get Involved</h4>
          <ul>
            <li>
              <a href="http://community.jboss.org/en/arquillian?view=discussions">Forums</a>
            </li>
            <li>
              <a href="https://issues.jboss.org/browse/ARQ">Issue Tracker</a>
            </li>
            <li>
              <a href="https://github.com/arquillian">Source Code</a>
            </li>
            <li>
              <a href="/community/contributors">Contributors</a>
            </li>
            <li>
              <a href="https://community.jboss.org/groups/testing">Testing SIG</a>
            </li>
          </ul>
        </div>
        <div class="sponser">
          <div class="follow-us">
            <h4>Stay Informed</h4>
            <ul>
              <li>
                <a href="https://plus.google.com/100660127586085393031"><img alt="Google+" src="/images/social/googleplus-16.png" title="Follow Arquillian on Google+" /></a>
              </li>
              <li>
                <a href="https://twitter.com/#!/search/%23arquillian"><img alt="Twitter" src="/images/social/twitter-16.png" title="Browse the #arquillian hashtag on Twitter" /></a>
              </li>
              <li>
                <a href="http://www.linkedin.com/groups?gid=3120340"><img alt="LinkedIn" src="/images/social/linkedin-16.png" title="Join the Arquillian group on LinkedIn" /></a>
              </li>
              <li>
                <a href="http://vimeo.com/channels/arquillian"><img alt="Vimeo" src="/images/social/vimeo-16.png" title="Follow the Arquillian channel on Vimeo" /></a>
              </li>
            </ul>
          </div>
          <p>This website is open source! If you want to improve it, <a href="http://github.com/arquillian/arquillian.github.com">fork the project</a>, hack on it, then send a pull request. You can also view the <a href="http://www.seethestats.com/site/arquillian.org">visitor stats</a>.</p>
          <p class="image"><a href="http://jboss.org"><img src="/images/jboss_redhat_branding.png" class="branding" title="Red Hat, Inc." alt="Red Hat, Inc." /></a></p>
          <p>Arquillian is a <a href="http://jboss.org">JBoss Community</a> project and development is sponsored by Red Hat, Inc.</p>
          <p class="bottom"><a href="http://www.redhat.com/legal/legal_statement.html">Terms of Use</a> | <a href="http://www.redhat.com/legal/privacy_statement.html">Privacy Policy</a></p>
        </div>
        <a class="visible-desktop" href="#" id="toTop">Top</a>
      </div>
    </footer>
    <script>
      $(function() {
        $('html').addClass('ready');
        prettify();
        activateFooterGravity();
        activateTooltips();
        activateToTopControl();
      });
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.0.2/bootstrap.min.js"></script>
    <script src="/javascripts/prettify.js"></script>
    <script src="/javascripts/site.js?bd6a597285db4e44c754379cff5581dc0b63ca5e"></script>
    <script src="/javascripts/jquery-scroll.js"></script>
    <script src="http://apis.google.com/js/plusone.js"></script>
    <script>
      (function() {
        var po = document.createElement('script'); po.async = true; po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount','UA-18727998-3']);
    _gaq.push(['_trackPageview']);
    (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </body>
</html>
